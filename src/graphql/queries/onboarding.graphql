# ==================================================================
# ONBOARDING - GraphQL Queries & Mutations
# ==================================================================

# Query: Check if user has completed onboarding
query GetUserOnboardingStatus($userId: UUID!) {
  profilesCollection(
    filter: { id: { eq: $userId } }
    first: 1
  ) {
    edges {
      node {
        id
        email
        onboarding_completed
        onboarding_step
        height_cm
        weight_kg
        age
        gender
        created_at
      }
    }
  }
}

# Query: Get user's quiz results
query GetUserQuizResults($userId: UUID!) {
  quiz_resultsCollection(
    filter: { user_id: { eq: $userId } }
    first: 1
  ) {
    edges {
      node {
        id
        user_id
        answers
        calculations
        created_at
      }
    }
  }
}

# Mutation: Save onboarding data to user profile
mutation SaveOnboardingData($userId: UUID!, $updates: profilesUpdateInput!) {
  updateprofilesCollection(
    filter: { id: { eq: $userId } }
    set: $updates
  ) {
    records {
      id
      email
      full_name
      age
      gender
      height_cm
      weight_kg
      target_weight_kg
      unit_system
      occupation_activity
      onboarding_completed
      onboarding_step
      updated_at
    }
    affectedCount
  }
}

# Mutation: Generate AI Meal Plan (after quiz)
mutation GenerateAIMealPlan($input: ai_meal_plansInsertInput!) {
  insertIntoai_meal_plansCollection(objects: [$input]) {
    records {
      id
      user_id
      quiz_result_id
      plan_data
      daily_calories
      daily_protein
      daily_carbs
      daily_fats
      preferences
      restrictions
      status
      is_active
      generated_at
      created_at
    }
    affectedCount
  }
}

# Mutation: Generate AI Workout Plan (after quiz)
mutation GenerateAIWorkoutPlan($input: ai_workout_plansInsertInput!) {
  insertIntoai_workout_plansCollection(objects: [$input]) {
    records {
      id
      user_id
      quiz_result_id
      plan_data
      workout_type
      duration_per_session
      frequency_per_week
      status
      is_active
      generated_at
      created_at
    }
    affectedCount
  }
}
