# ==================================================================
# NUTRITION & WORKOUT LOGS - GraphQL Queries & Mutations
# ==================================================================

# ==================================================================
# DAILY NUTRITION LOGS
# ==================================================================

# Query: Get nutrition logs for a specific date
query GetDailyNutritionLogs($userId: UUID!, $logDate: Date!) {
  daily_nutrition_logsCollection(
    filter: { user_id: { eq: $userId }, log_date: { eq: $logDate } }
    first: 100
  ) {
    edges {
      node {
        id
        user_id
        log_date
        meal_type
        total_calories
        total_protein
        total_carbs
        total_fats
        notes
        created_at

        items: meal_itemsCollection {
          edges {
            node {
              id
              food_id
              food_name
              brand_name
              serving_qty
              serving_unit
              calories
              protein
              carbs
              fats
              fiber
              sugar
              sodium
              notes
            }
          }
        }
      }
    }
  }
}

# Query: Get nutrition logs for a user (recent entries)
query GetRecentNutritionLogs($userId: UUID!, $first: Int = 10) {
  daily_nutrition_logsCollection(filter: { user_id: { eq: $userId } }, first: $first) {
    edges {
      node {
        id
        user_id
        log_date
        meal_type
        total_calories
        total_protein
        total_carbs
        total_fats
        notes
        created_at

        items: meal_itemsCollection {
          edges {
            node {
              id
              food_id
              food_name
              brand_name
              serving_qty
              serving_unit
              calories
              protein
              carbs
              fats
              fiber
              sugar
              sodium
              notes
            }
          }
        }
      }
    }
  }
}

# Query: Get nutrition logs by meal type
query GetNutritionLogsByMeal($userId: UUID!, $logDate: Date!, $mealType: String!) {
  daily_nutrition_logsCollection(
    filter: { user_id: { eq: $userId }, log_date: { eq: $logDate }, meal_type: { eq: $mealType } }
    first: 100
  ) {
    edges {
      node {
        id
        user_id
        log_date
        meal_type
        total_calories
        total_protein
        total_carbs
        total_fats
        notes
        created_at

        items: meal_itemsCollection {
          edges {
            node {
              id
              food_id
              food_name
              brand_name
              serving_qty
              serving_unit
              calories
              protein
              carbs
              fats
              fiber
              sugar
              sodium
              notes
            }
          }
        }
      }
    }
  }
}

# Mutation: Log nutrition entry
mutation CreateNutritionLog(
  $userId: UUID!
  $logDate: Date!
  $mealType: String!
  $notes: String
  $items: [meal_itemsInsertInput!]!
) {
  insertIntodaily_nutrition_logsCollection(
    objects: [{ user_id: $userId, log_date: $logDate, meal_type: $mealType, notes: $notes }]
  ) {
    records {
      id
    }
  }
  insertIntomeal_itemsCollection(objects: $items) {
    affectedCount
  }
}

# Mutation: Update nutrition entry
mutation UpdateNutrition($id: UUID!, $set: daily_nutrition_logsUpdateInput!) {
  updatedaily_nutrition_logsCollection(filter: { id: { eq: $id } }, set: $set) {
    records {
      id
      user_id
      log_date
      meal_type
      total_calories
      total_protein
      total_carbs
      total_fats
      notes
      created_at

      items: meal_itemsCollection {
        edges {
          node {
            id
            food_id
            food_name
            brand_name
            serving_qty
            serving_unit
            calories
            protein
            carbs
            fats
            fiber
            sugar
            sodium
            notes
          }
        }
      }
    }
    affectedCount
  }
}

# Mutation: Delete nutrition entry
mutation DeleteNutrition($id: UUID!) {
  deleteFromdaily_nutrition_logsCollection(filter: { id: { eq: $id } }) {
    records {
      id
    }
    affectedCount
  }
}

mutation UpdateMealItem($id: UUID!, $set: meal_itemsUpdateInput!) {
  updatemeal_itemsCollection(filter: { id: { eq: $id } }, set: $set) {
    affectedCount
  }
}

mutation DeleteMealItem($id: UUID!) {
  deleteFrommeal_itemsCollection(filter: { id: { eq: $id } }) {
    affectedCount
  }
}
